---
title: Исследования о документировании кода
last_updated: Oct 11, 2019
sidebar: mydoc_sidebar
permalink: doc-research.html
folder: doc-code
---

Прежде чем изучать, как документировать код, давайте посмотрим на исследования передовых методов документирования кода, так как это может определить наше направление и подход.

Несколько академических статей выделяются как заслуживающие внимания:

- **Когда не нужно комментировать: вопросы и компромиссы документации API для проектов на C++**

В этой статье рассказывается, как разработчики из Google ищут и пользуются документацией кода. Исследователи обнаружили, что иногда простой код разработчики предпочитают исследовать напрямую. Однако, видя сложный код, разработчики обращаются к документации, часто просматривая формальные объявления классов для получения нужной информации. Бывает, смотрят и на комментарии в коде реализации. Помимо предоставления руководства по наилучшему расположению документации, исследователи также пытаются понять, какие типы ответов и рекомендации разработчики хотят получить в документации.

- **Как разработчики используют документацию API: изучение наблюдений**

В этой статье исследователи смотрели на то, как разработчики взаимодействуют с документацией API, и обнаружили сочетание как систематического (сначала читайте, изучайте потом), так и оппортунистического (изучайте сначала, читайте потом) стилей обучения. Хотя мы часто пишем систематически, сосредоточение внимания на оппортунистическом поведении может быть более полезным, что побудит нас внимательнее следить за улучшением поиска, навигации, интерактивных компонентов, устранения неполадок, сообщений об ошибках и других функций, ориентированных на действия.

Обе эти статьи взяты из научных журналов. На самом деле редко можно найти исследования о документации API в академических журналах (не знаю почему), чаще они встречаются в инженерных журналах, или журналах по информатике (а не в журналах по техническим коммуникациям).

## Когда не нужно комментировать: вопросы и компромиссы документации API для проектов на C++

Во-первых, давайте рассмотрим статью «Когда не нужно комментировать: вопросы и компромиссы в документации API для проектов C++», написанную авторами Эндрю Хэдом, Кейтлин Садовски, Эмерсон Мерфи-Хилл и Андреа Найт. Эта статья была опубликована в 2018 году на 40-й Международной конференции ACM / IEEE по разработке программного обеспечения.

Статью можно почитать на сайте [ResearchGate](https://www.researchgate.net/publication/325732077_When_not_to_comment_questions_and_tradeoffs_with_API_documentation_for_C_projects). Можно посмотреть версию [.pdf](https://people.eecs.berkeley.edu/~andrewhead/pdf/comment.pdf)

Эта статья включает труды исследователей, инженеров, юзабилити-специалистов и членов команды Google Engineering Productivity Research. Учитывая, насколько важна документация для понимания кода, исследователи пытаются понять, где лучшее место для документации, а также то, что нужно инженерам от документации. В частности, они сосредоточились на API C++ и спросили, что важнее для получения необходимой информации:

- заголовочные файлы с определениями классов;
- файлы реализации классов.

Следующий скриншот (из их статьи) показывает разницу между двумя видами файлов:

{% include image.html file="doc-code/2.png" alt="screenshot" %}

В основном, в C++ заголовочные классы (`.h`) содержат классы и основную документацию. Файлы реализации (`.cc`) создают и реализуют классы из заголовочных файлов. Короче говоря, файлы заголовков содержат более формальную документацию, которая следует определенным соглашениям аннотаций, в то время как файлы реализации содержат внутреннюю логику того, как класс был реализован. Файлы реализации имеют комментарии, перпендикулярные встраиваемому коду, без формально структурированных аннотаций документов. Главный вопрос, который исследователи хотели узнать, - тяготеют ли пользователи к комментариям встроенного кода в файлах реализации или официальной документации в заголовочных файлах.

Исследователи изучали, когда разработчики переключатся с одного типа файла на другой, и задавали уточняющие вопросы разработчикам. В центральном хранилище кода Google хранится около миллиарда строк кода, которые можно использовать в рамках всей компании, поэтому тысячи разработчиков могут искать код в этом едином репозитории и использовать в своих проектах. Команда, которая использует API, может не знать команду, которая разработала API, и наоборот.

Данное исследование полезно всем, даже тем, кто не документирует С++, потому что оно затрагивает **Главный вопрос о жизни, вселенной и вообще:**

**Следует ли добавлять основную часть документации в формальные описания кода или большая часть вашей документации появляется в контексте кода, заправлено в виде встроенных комментариев?**

{% include note.html content="Хотя этот вопрос тоже не подходит под ответ **42**" %}

После сбора информации от более чем 600 участников, исследователи обнаружили, что не весь код одинаков. Сложный код требует более формальной документации, тогда как простой код может вообще не нуждаться в документации.

### Тип кода, которому нужна документация

Во-первых, исследователи обнаружили, что большинство разработчиков на самом деле искали в заголовочных файлах документацию:

{% include callout.html content="Респонденты отвечали, что было бы наиболее удобно найти ответы на многие из этих вопросов в заголовочных файлах, хотя и замечали, что код может быть точным и достаточно удобным для восприятия во многих случаях. " type="primary" %}

Интересно заметить, что для более простых API многие разработчики читают код напрямую (а не обращаются к документации), чтобы быстрее понять API. Другими словами, они понимают что происходит, глядя исключительно на код.

Некоторые разработчики придерживаются философских взглядов к точности и актуальности документации и предпочитают рассматривать код в качестве основного источника информации, вместо вторичных или третьих источников информации. Как известно многим разработчикам, которые не доверяют документации, документация может легко устареть, так зачем ей доверять? Зачем вообще читать?

Фактически, такие разработчики считают, что документация для простого кода является помехой и препятствием для разработки. Документ встает на пути разработчика при чтении кода.

Помимо отказа от документации простого кода, исследователи также рекомендуют избегать написания документации для разработки, находящейся в постоянном движении (поскольку она делает документацию постоянно развивающейся целью). Исследователи пришли к выводу, что можно пропустить написание документов, когда не хватает ресурсов для ее обновления. Когда поддержание документации в актуальном состоянии хромает, она «гниет» и становится большой обузой.

Короче говоря, есть веские аргументы против написания документации, особенно для простого кода. Следующая диаграмма показывает, когда документация может не потребоваться с кодом:

{% include image.html file="doc-code/3.png" alt="аргументы против" %}

Тем не менее, для понимания сложного кода, особенно когда могут быть задействованы несколько файлов и сгенерированный код, разработчики все еще полагались на формальную документацию. Исследователи объясняют следующим:

{% include callout.html content="Когда коду нужна документация? Иногда разработчики без проблем читают код, обходясь без поиска более точной информации (самодокументируемый код). Однако в некоторых случаях самостоятельное документирование невозможно, например, код с чрезмерно сложными сигнатурами методов и сгенерированный код. Такие детали, как например Рекомендуемое использование просто не могут быть переданы исходным кодом. " type="primary" %}

Короче говоря, когда исходный код не понятен интуитивно, разработчики обращались к более объемной и формальной документации. Такой подход имеет смысл и согласуется с лучшими практиками для документации GUI - всегда следует сосредоточиться на сложных частях системы, а [не на очевидных элементах](https://idratherbewriting.com/2013/09/04/sticking-with-obvious-information/), которые и так понятны каждому.

Конечно, понять разницу между простым кодом и сложным техническому писателю сложнее, чем разработчику, потому что у писателя может быть лишь элементарное представление о сложности кода. Тот факт, что код короткий или длинный, не дает четкого представления о его сложности. Короткий фрагмент вне контекста может сбивать с толку, в то время как более длинный кусок, который содержит полностью функционирующий образец, может быть более понятным.

Приведу аналогию,  путешественник посещает город в далекой стране. Посторонний не будет знать, является ли какое-то наблюдаемое событие нормальным или необычным - нужно быть более знакомым с местностью, чтобы оценить, является ли событие странным или обычным. То же самое с кодом.

Можно спросить разработчиков об уровне сложности кода, что предполагает доверие мнению инженеров, которые проектировали и создавали код. Разработчики почти всегда переоценивают уровень интуитивности написанного ими кода, а также и возможности аудитории. Сколько раз вы слышали, как инженеры говорили: «Пользователи поймут код, но если они этого не сделают, им *не следует* использовать API». Так что рискованнее: отсутствие документации или ее наличие?

Более продвинутые разработчики, вероятно, могут экстраполировать использование API из кода, в то время как начинающим разработчикам может потребоваться больше ручного труда. Как влияют комментарии на удобочитаемость для продвинутых разработчиков, и как они помогают новичкам? Обречены ли мы расстроить одну аудиторию, чтобы помочь другой? В чем риска больше: отсутствие документации или перегрузка ее слишком подробными пояснениями?

### Когда документировать код

Отложим пока вопрос о том, документировать или нет, и вместо этого сосредоточимся на сроках написания документов. Исследователи обнаружили, что существует идеальное время для написания и обновления документации:

{% include callout.html content="Идеальное время для внесения изменений в документацию - во время написания и проверки кода, возможно, с помощью рецензента кода. Документация может обновляться нечасто после первоначального написания, поскольку в будущих обновлениях могут возникнуть вопросы о ее избыточности. " type="primary" %}

Другими словами, пишем документы по горячим следам. Если слишком долго ждать после окончания активной разработки, про документацию мало кто вспомнить, так как разработчики займутся другими проектами.

Конечно, сроки не всегда легко спланировать. Доступность тех. писателя может не соответствовать спринтам разработчика. Тех. писатель может работать с проектами со своими сроками, поэтому приходится откладывать документацию на один или более месяцев после разработки. Но к тому времени разработчик может и забыть какие-то детали. Сложность заключается в том, что мы храним множество деталей в наших головах (в нашей кратковременной памяти) пока мы работаем над задачей, но как только мы идем дальше, мозг выбрасывает информацию из краткосрочной памяти, чтобы загрузить оперативную память нашего мозга другим проектом.

В попытках получить от разработчиков четко сформулированные детали, которые больше не находятся в центре их внимания, можно столкнуться с низкой мотивацией и энтузиазмом при проверке документации. Они уже двинулись дальше. Куй железо пока горячо.



### Вопросы, решаемые в документации кода


### Заключение


## Как разработчики используют документацию API: изучение наблюдений


### Систематическое поведение против оппортунистического


### Проектирование для оппортунистического поведения


### Временные затраты пользователей


### Заключение


## Выводы исследований

[🔙](doc-code.html)

[Go next ➡](doc-strategy.html)
